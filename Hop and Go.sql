--Part1 Q1--
DROP TABLE DRIVER CASCADE CONSTRAINT;
DROP TABLE VEHICLE CASCADE CONSTRAINT;
DROP TABLE PASSENGER CASCADE CONSTRAINT;
DROP TABLE RIDE CASCADE CONSTRAINT;
DROP TABLE LOYALTYPROGRAM CASCADE CONSTRAINT;
DROP TABLE PAYMENT CASCADE CONSTRAINT;
DROP TABLE REVIEW CASCADE CONSTRAINT;


CREATE TABLE DRIVER (
    DriverID CHAR(10) PRIMARY KEY,
    FirstName VARCHAR(20) NOT NULL,
    LastName VARCHAR(20) NOT NULL,
    LicenseNumber VARCHAR(9) UNIQUE NOT NULL,
    PhoneNumber CHAR(10) UNIQUE NOT NULL,
    Email VARCHAR(50) UNIQUE NOT NULL,
    VerificationStatus CHAR(3) NOT NULL,
    AverageRating NUMERIC(5,2),
    RegistrationDate DATE,
    Earnedtotal Numeric (7,2)
);

CREATE TABLE VEHICLE (
    VehicleID CHAR(10) PRIMARY KEY,
    DriverID CHAR(10),
    VehicleType VARCHAR(10) NOT NULL,
    VehicleModel VARCHAR(20) NOT NULL,
    VehicleYear NUMERIC(4),
    RegistrationNumber NUMERIC(5) NOT NULL,
    InsuranceExpiryDate DATE,
    FOREIGN KEY (DriverID) REFERENCES DRIVER(DriverID)
);

CREATE TABLE PASSENGER (
    PassengerID CHAR(10) PRIMARY KEY,
    FirstName VARCHAR(20) NOT NULL,
    LastName VARCHAR(20) NOT NULL,
    Email VARCHAR(50) UNIQUE NOT NULL,
    PhoneNumber CHAR(10) UNIQUE NOT NULL,
    RegistrationDate DATE,
    LoyaltyPoints NUMERIC(10,2)
);

CREATE TABLE RIDE (
    RideID CHAR(10) PRIMARY KEY,
    PassengerID CHAR(10),
    DriverID CHAR(10),
    VehicleID CHAR(10),
    PickupLocation VARCHAR(50),
    DropoffLocation VARCHAR(50),
    RideStartTime TIMESTAMP,
    RideEndTime TIMESTAMP,
    Distance NUMERIC(7,3),
    BasePrice NUMERIC(5,2),
    SurgePriceMultiplier NUMERIC(3,2),
    TotalPrice NUMERIC(7,2),
    RideDate Date,
    FOREIGN KEY (PassengerID) REFERENCES PASSENGER(PassengerID),
    FOREIGN KEY (DriverID) REFERENCES DRIVER(DriverID),
    FOREIGN KEY (VehicleID) REFERENCES VEHICLE(VehicleID)
);

CREATE TABLE LOYALTYPROGRAM (
    LoyaltyProgramID CHAR(10) PRIMARY KEY,
    PassengerID CHAR(10),
    PointsEarned NUMERIC(10),
    PointsRedeemed NUMERIC(10),
    ValidUntil DATE,
    FOREIGN KEY (PassengerID) REFERENCES PASSENGER(PassengerID)
);

CREATE TABLE PAYMENT (
    PaymentID CHAR(10) PRIMARY KEY,
    RideID CHAR(10),
    PaymentMethod VARCHAR(10) NOT NULL,
    PaymentStatus CHAR(3) NOT NULL,
    PaymentAmount NUMERIC(7,2) NOT NULL,
    PaymentTime TIMESTAMP,
    FOREIGN KEY (RideID) REFERENCES RIDE(RideID)
);

CREATE TABLE REVIEW (
    ReviewID CHAR(10) PRIMARY KEY,
    RideID CHAR(10),
    PassengerRating NUMERIC(3,1),
    DriverRating NUMERIC(3,1),
    PassengerReview VARCHAR(200),
    DriverReview VARCHAR(200),
    ReviewTime TIMESTAMP,
    FOREIGN KEY (RideID) REFERENCES RIDE(RideID)
);

--Part1 Q2--

INSERT INTO DRIVER VALUES('D0001', 'John', 'Doe', 'L0001', '555123401', 'johndoe@example.com', 'YES', 3.97, TO_DATE('2021-06-10', 'YYYY-MM-DD'), 118.62);
INSERT INTO DRIVER VALUES('D0002', 'Jane', 'Smith', 'L0002', '555123402', 'janesmith@example.com', 'YES', 3.85, TO_DATE('2020-06-10', 'YYYY-MM-DD'), 102.94);
INSERT INTO DRIVER VALUES('D0003', 'Robert', 'Johnson', 'L0003', '555123403', 'robertjohnson@example.com', 'YES', 4.76, TO_DATE('2023-01-19', 'YYYY-MM-DD'), 271.41);
INSERT INTO DRIVER VALUES('D0004', 'Emily', 'Davis', 'L0004', '555123404', 'emilydavis@example.com', 'YES', 3.53, TO_DATE('2020-08-01', 'YYYY-MM-DD'), 97.06);
INSERT INTO DRIVER VALUES('D0005', 'Michael', 'Brown', 'L0005', '555123405', 'michaelbrown@example.com', 'YES', 3.89, TO_DATE('2021-10-11', 'YYYY-MM-DD'), 154.91);
INSERT INTO DRIVER VALUES('D0006', 'Jessica', 'Williams', 'L0006', '555123406', 'jessicawilliams@example.com', 'YES', 4.49, TO_DATE('2022-10-07', 'YYYY-MM-DD'), 215.01);
INSERT INTO DRIVER VALUES('D0007', 'David', 'Jones', 'L0007', '555123407', 'davidjones@example.com', 'NO', NULL, TO_DATE('2020-05-03', 'YYYY-MM-DD'), 0.00);
INSERT INTO DRIVER VALUES('D0008', 'Sarah', 'Miller', 'L0008', '555123408', 'sarahmiller@example.com', 'NO', NULL, TO_DATE('2022-05-27', 'YYYY-MM-DD'), 0.00);
INSERT INTO DRIVER VALUES('D0009', 'Daniel', 'Garcia', 'L0009', '555123409', 'danielgarcia@example.com', 'NO', NULL, TO_DATE('2021-07-07', 'YYYY-MM-DD'), 0.00);
INSERT INTO DRIVER VALUES('D0010', 'Laura', 'Martinez', 'L0010', '555123410', 'lauramartinez@example.com', 'NO', NULL, TO_DATE('2023-09-03', 'YYYY-MM-DD'), 0.00);


INSERT INTO VEHICLE VALUES('V0001', 'D0001', 'Sedan', 'Toyota Corolla', 2020, 11617 , TO_DATE('2024-09-21', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0002', 'D0002', 'Sedan', 'Honda Civic', 2019, 46772 , TO_DATE('2024-10-01', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0003', 'D0003', 'SUV', 'Proton X50', 2020, 71279 , TO_DATE('2024-09-17', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0004', 'D0004', 'Sedan', 'Chevrolet Malibu', 2020, 18050 , TO_DATE('2025-09-18', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0005', 'D0005', 'Sedan', 'Tesla Model 3', 2022, 81276 , TO_DATE('2025-09-30', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0006', 'D0006', 'SUV', 'Toyota Corolla Cross', 2022, 43324 , TO_DATE('2025-09-26', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0007', 'D0007', 'Hatchback', 'Ford Focus', 2020, 43224 , TO_DATE('2026-09-20', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0008', 'D0008', 'Sedan', 'Kia Optima', 2021, 10102 , TO_DATE('2026-09-23', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0009', 'D0009', 'SUV', 'Perodua Aruz', 2019, 72253 , TO_DATE('2026-09-25', 'YYYY-MM-DD'));
INSERT INTO VEHICLE VALUES('V0010', 'D0010', 'Hatchback', 'Subaru Impreza', 2023, 92262 , TO_DATE('2026-10-02', 'YYYY-MM-DD'));
 

INSERT INTO PASSENGER VALUES('P0001', 'Alice', 'Johnson', 'alice.johnson@example.com', '555000001', TO_DATE('2021-03-15', 'YYYY-MM-DD') , 8796);
INSERT INTO PASSENGER VALUES('P0002', 'Bob', 'Smith', 'bob.smith@example.com', '555000002' , TO_DATE('2022-06-20', 'YYYY-MM-DD') , 6207);
INSERT INTO PASSENGER VALUES('P0003', 'Charlie', 'Brown', 'charlie.brown@example.com', '555000003', TO_DATE('2020-08-05', 'YYYY-MM-DD') , 3233);
INSERT INTO PASSENGER VALUES('P0004', 'Diana', 'Ross', 'diana.ross@example.com', '555000004', TO_DATE('2019-11-25', 'YYYY-MM-DD') , 748);
INSERT INTO PASSENGER VALUES('P0005', 'Ethan', 'Hunt', 'ethan.hunt@example.com', '555000005', TO_DATE('2023-01-10', 'YYYY-MM-DD') , 8364);
INSERT INTO PASSENGER VALUES('P0006', 'Fiona', 'Gallagher', 'fiona.gallagher@example.com', '555000006', TO_DATE('2021-05-30', 'YYYY-MM-DD'), 4521);
INSERT INTO PASSENGER VALUES('P0007', 'George', 'Clooney', 'george.clooney@example.com', '555000007', TO_DATE('2020-12-15', 'YYYY-MM-DD'), 2190);
INSERT INTO PASSENGER VALUES('P0008', 'Hannah', 'Baker', 'hannah.baker@example.com', '555000008', TO_DATE('2022-09-12', 'YYYY-MM-DD'), 5873);



INSERT INTO RIDE VALUES('R0001', 'P0001', 'D0001', 'V0001' , 'Downtown', 'Airport', TO_TIMESTAMP('2023-09-15 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-15 08:42:00', 'YYYY-MM-DD HH24:MI:SS'), 14.000 , 35.50 , 3.10 , 38.60,TO_DATE('2023-09-15','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0002', 'P0002', 'D0001', 'V0001' , 'Mall', 'Hotel', TO_TIMESTAMP('2024-11-16 09:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-11-16 09:20:00', 'YYYY-MM-DD HH24:MI:SS'), 7.750 , 20.00 , 0 , 20.00,TO_DATE('2024-11-16','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0003', 'P0003', 'D0003', 'V0001' , 'Station', 'University', TO_TIMESTAMP('2023-09-17 14:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-17 14:18:00', 'YYYY-MM-DD HH24:MI:SS'), 6.000 , 15.75 , 0 , 15.75,TO_DATE('2023-09-17','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0004', 'P0001', 'D0003', 'V0002' , 'Park', 'Museum', TO_TIMESTAMP('2024-11-18 11:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-11-18 12:00:00', 'YYYY-MM-DD HH24:MI:SS'), 10.000 , 25.30 , 3.10 , 28.40,TO_DATE('2024-11-18','YYYY-MM-DD')) ;
INSERT INTO RIDE VALUES('R0005', 'P0002', 'D0002', 'V0002' , 'Suburbs', 'Downtown', TO_TIMESTAMP('2023-09-19 15:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-19 16:00:00', 'YYYY-MM-DD HH24:MI:SS'), 18.000 , 45.00 , 0 , 45.00,TO_DATE('2023-09-19','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0006', 'P0003', 'D0002', 'V0002' , 'Airport', 'Hotel', TO_TIMESTAMP('2024-12-20 10:15:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-12-20 10:50:00', 'YYYY-MM-DD HH24:MI:SS'), 11.250 , 30.00 , 3.10 , 33.10,TO_DATE('2024-12-20','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0007', 'P0004', 'D0003', 'V0003' , 'Station', 'Mall', TO_TIMESTAMP('2023-09-21 13:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-21 13:30:00', 'YYYY-MM-DD HH24:MI:SS'), 7.500 , 22.50 , 0 , 22.50,TO_DATE('2023-09-21','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0008', 'P0005', 'D0003', 'V0003' , 'University', 'Park', TO_TIMESTAMP('2023-09-22 17:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-22 17:55:00', 'YYYY-MM-DD HH24:MI:SS'), 20.000 , 40.75 , 0 , 40.75,TO_DATE('2023-09-22','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0009', 'P0001', 'D0003', 'V0003' , 'Museum', 'Downtown', TO_TIMESTAMP('2023-09-23 09:45:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-23 10:10:00', 'YYYY-MM-DD HH24:MI:SS'), 9.750 , 18.50 , 3.10 , 21.60,TO_DATE('2023-09-23','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0010', 'P0002', 'D0006', 'V0004' , 'Mall', 'Station', TO_TIMESTAMP('2023-09-24 07:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-24 08:05:00', 'YYYY-MM-DD HH24:MI:SS'), 12.750 , 35.00 , 0 , 35.00,TO_DATE('2023-09-24','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0011', 'P0003', 'D0004', 'V0004' , 'Park', 'University', TO_TIMESTAMP('2024-10-25 16:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-10-25 16:30:00', 'YYYY-MM-DD HH24:MI:SS'), 10.000 , 25.50 , 0 , 25.50,TO_DATE('2024-10-25','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0012', 'P0004', 'D0004', 'V0004' , 'Airport', 'Museum', TO_TIMESTAMP('2024-10-26 12:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-10-26 12:25:00', 'YYYY-MM-DD HH24:MI:SS'), 6.750 , 19.75 , 0 , 19.75,TO_DATE('2024-10-26','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0013', 'P0005', 'D0005', 'V0005' , 'Suburbs', 'Mall', TO_TIMESTAMP('2023-09-27 14:15:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-27 15:05:00', 'YYYY-MM-DD HH24:MI:SS'), 18.100 , 45.25 , 3.10 , 48.35,TO_DATE('2023-09-27','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0014', 'P0001', 'D0006', 'V0005' , 'Downtown', 'Station', TO_TIMESTAMP('2023-09-28 08:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-28 09:00:00', 'YYYY-MM-DD HH24:MI:SS'), 9.000 , 30.00 , 0 , 30.00,TO_DATE('2023-09-28','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0015', 'P0002', 'D0005', 'V0005' , 'University', 'Park', TO_TIMESTAMP('2024-11-29 19:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-11-29 20:10:00', 'YYYY-MM-DD HH24:MI:SS'), 22.500 , 50.00 , 0 , 50.00,TO_DATE('2024-11-29','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0016', 'P0003', 'D0006', 'V0006' , 'Station', 'Airport', TO_TIMESTAMP('2023-09-30 10:30:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2023-09-30 11:00:00', 'YYYY-MM-DD HH24:MI:SS'), 12.000 , 28.00 , 3.10 , 31.10,TO_DATE('2023-09-30','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0017', 'P0004', 'D0006', 'V0006' , 'Mall', 'Downtown', TO_TIMESTAMP('2024-11-01 16:15:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-11-01 16:50:00', 'YYYY-MM-DD HH24:MI:SS'), 13.500 , 33.50 , 0 , 33.50,TO_DATE('2024-11-01','YYYY-MM-DD'));
INSERT INTO RIDE VALUES('R0018', 'P0005', 'D0006', 'V0006' , 'Museum', 'Suburbs', TO_TIMESTAMP('2024-11-02 20:00:00', 'YYYY-MM-DD HH24:MI:SS'), TO_TIMESTAMP('2024-11-02 20:50:00', 'YYYY-MM-DD HH24:MI:SS'), 17.500 , 40.00 , 0 , 40.00,TO_DATE('2024-11-02','YYYY-MM-DD'));


INSERT INTO LOYALTYPROGRAM VALUES('LP0001', 'P0001', 150 , 120 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0002', 'P0002', 120 , 170 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0003', 'P0003', 100 , 30 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0004', 'P0004', 90 , 180 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0005', 'P0005', 200 , 90 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0006', 'P0006', 365 , 163 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0007', 'P0007', 271 , 81 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO LOYALTYPROGRAM VALUES('LP0008', 'P0008', 263 , 336 , TO_TIMESTAMP('2025-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'));


INSERT INTO PAYMENT VALUES('PAY001', 'R0001', 'Credit', 'Suc' , 35.50 , TO_TIMESTAMP('2023-09-15 08:42:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY002', 'R0002', 'Credit', 'Suc' , 20.00 , TO_TIMESTAMP('2024-11-16 09:20:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY003', 'R0003', 'Credit', 'Suc' , 15.75 , TO_TIMESTAMP('2023-09-17 14:18:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY004', 'R0004', 'Debit', 'Suc' , 25.30 , TO_TIMESTAMP('2024-11-18 12:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY005', 'R0005', 'Credit', 'Suc' , 45.00 , TO_TIMESTAMP('2023-09-19 16:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY006', 'R0006', 'Credit', 'Suc' , 30.00 , TO_TIMESTAMP('2024-12-20 10:50:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY007', 'R0007', 'Debit', 'Suc' , 22.50 , TO_TIMESTAMP('2023-09-21 13:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY008', 'R0008', 'Debit', 'Suc' , 40.75 , TO_TIMESTAMP('2023-09-22 17:55:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY009', 'R0009', 'Credit', 'Suc' , 18.50 , TO_TIMESTAMP('2023-09-23 10:10:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY010', 'R0010', 'Debit', 'Suc' , 35.00 , TO_TIMESTAMP('2023-09-24 08:05:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY011', 'R0011', 'Debit', 'Suc' , 25.50 , TO_TIMESTAMP('2024-10-25 16:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY012', 'R0012', 'Credit', 'Suc' , 19.75 , TO_TIMESTAMP('2024-10-26 12:25:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY013', 'R0013', 'Credit', 'Suc' , 45.25 , TO_TIMESTAMP('2023-09-27 15:05:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY014', 'R0014', 'Debit', 'Suc' , 30.00 , TO_TIMESTAMP('2023-09-28 09:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY015', 'R0015', 'Credit', 'Suc' , 50.00 , TO_TIMESTAMP('2024-11-29 20:10:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY016', 'R0016', 'Debit', 'Suc' , 28.00 , TO_TIMESTAMP('2023-09-30 11:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY017', 'R0017', 'Debit', 'Suc' , 33.50 , TO_TIMESTAMP('2024-11-01 16:50:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO PAYMENT VALUES('PAY018', 'R0018', 'Credit', 'Suc' , 40.00 , TO_TIMESTAMP('2024-11-02 20:50:00', 'YYYY-MM-DD HH24:MI:SS'));


INSERT INTO REVIEW VALUES('REV001', 'R0001', 5.0, 4.1, 'Great service!' , 'Good passenger overall, but a bit late to the pickup point.', TO_TIMESTAMP('2023-09-15 08:42:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV002', 'R0002', 4.4, 5.0, 'Good ride, but traffic was bad.' , 'Great passenger! Very polite and respectful throughout the ride.' , TO_TIMESTAMP('2024-11-16 09:20:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV003', 'R0003', 5.0, 3.6, 'Very friendly driver.' , 'Decent passenger, but was late and caused some delay.' , TO_TIMESTAMP('2023-09-17 14:18:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV004', 'R0004', 4.7, 5.0, 'Quick and comfortable.' , 'A smooth and pleasant experience. Highly recommended!' , TO_TIMESTAMP('2024-11-18 12:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV005', 'R0005', 5.0, 5.0, 'Excellent service!' , 'Clean and courteous. A pleasure to have in the car!' , TO_TIMESTAMP('2023-09-19 16:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV006', 'R0006', 3.9, 3.8, 'Average experience.' , 'Okay experience, but better communication would have helped.' , TO_TIMESTAMP('2024-12-20 10:50:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV007', 'R0007', 5.0, 4.2, 'Great ride!' , 'Ride was mostly fine, but clearer communication would have made it better.' , TO_TIMESTAMP('2023-09-21 13:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV008', 'R0008', 4.4, 4.1, 'Driver was polite.' , 'A pleasant passenger, though there was a slight issue with timing.' , TO_TIMESTAMP('2023-09-22 17:55:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV009', 'R0009', 5.0, 5.0, 'Exceptional service!' , 'Passenger was polite, but there were issues with cleanliness.' , TO_TIMESTAMP('2023-09-23 10:10:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV010', 'R0010', 3.1, 5.0, 'Could be better.' , 'Wonderful passenger, made the trip enjoyable. Perfect interaction!' , TO_TIMESTAMP('2023-09-24 08:05:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV011', 'R0011', 4.6, 3.7, 'Good experience overall.' , 'Ride was acceptable, but the passengers attitude could improve.' , TO_TIMESTAMP('2024-10-25 16:30:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV012', 'R0012', 5.0, 5.0, 'Driver was very helpful.' , 'Punctual, friendly, and easy to communicate with. Would gladly drive again!' , TO_TIMESTAMP('2024-10-26 12:25:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV013', 'R0013', 4.4, 4.2, 'Pleasant journey.' , 'Overall a good experience. Just a little more attentiveness next time!' , TO_TIMESTAMP('2023-09-27 15:05:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV014', 'R0014', 5.0, 4.0, 'Driver went the extra mile!' , 'Good passenger overall, but a bit late to the pickup point.' , TO_TIMESTAMP('2023-09-28 09:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV015', 'R0015', 4.3, 3.1, 'Great ride overall.' , 'Not the worst experience, but definitely room for improvement.' , TO_TIMESTAMP('2024-11-29 20:10:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV016', 'R0016', 3.7, 4.5, 'Fair service.' , 'Friendly and polite, but left some minor mess behind.' , TO_TIMESTAMP('2023-09-30 11:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV017', 'R0017', 5.0, 5.0, 'Loved the experience!' , 'A smooth and pleasant experience. Highly recommended!' , TO_TIMESTAMP('2024-11-01 16:50:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO REVIEW VALUES('REV018', 'R0018', 4.0, 4.0, 'Driver was friendly.' , 'Ride was mostly fine, but clearer communication would have made it better.' , TO_TIMESTAMP('2024-11-02 20:50:00', 'YYYY-MM-DD HH24:MI:SS'));


--Part 1 Q3--

--- A ---
SELECT p.PassengerID, p.FirstName, p.LastName, p.RegistrationDate, r.RideID
FROM PASSENGER p 
LEFT JOIN RIDE r ON r.PassengerID = p.PassengerID
WHERE r.RideID IS NULL
ORDER BY p.RegistrationDate;

--- B ---
SELECT d.DriverID, d.FirstName, d.LastName, d.Earnedtotal, d.AverageRating, COUNT(r.RideID) AS "Total Rides"
FROM DRIVER d
JOIN RIDE r ON r.DriverID = d.DriverID
JOIN PAYMENT pmt ON pmt.RideID = r.RideID
JOIN REVIEW rw ON rw.RideID = r.RideID
JOIN PASSENGER p ON p.PassengerID = r.PassengerID
GROUP BY d.DriverID, d.FirstName, d.LastName, d.Earnedtotal, d.AverageRating
ORDER BY d.Earnedtotal DESC;

--- C ---
SELECT VehicleID, VehicleType, VehicleModel, InsuranceExpiryDate  
FROM VEHICLE 
WHERE  VehicleType LIKE '%Sedan%' AND TO_CHAR(InsuranceExpiryDate, 'YYYY') = '2024'
ORDER BY InsuranceExpiryDate;

--- D ---
SELECT RideID, PassengerID, DriverID, TotalPrice, Distance, RideDate
FROM RIDE
WHERE (TotalPrice > 30 OR Distance > 10) 
AND TO_CHAR(RideDate, 'YYYY') = '2024'
ORDER BY RideDate DESC;

--- E ---
SELECT DriverID, FirstName, LastName
FROM DRIVER
WHERE DriverID NOT IN (
    SELECT DISTINCT DriverID
    FROM RIDE
    WHERE DriverID IS NOT NULL
)
AND DriverID IN (
    SELECT DriverID
    FROM VEHICLE
);

--- F ---
SELECT d.DriverID, d.FirstName, d.LastName, COUNT(r.RideID) AS "Completed Trips Within Last Month", d.AverageRating, r.RideDate
FROM DRIVER d
JOIN RIDE r ON r.DriverID = d.DriverID
JOIN REVIEW rw ON rw.RideID = r.RideID
WHERE d.AverageRating >= 4.5 AND TO_CHAR(r.RideDate, 'MM') = '11'
GROUP BY d.DriverID, d.FirstName, d.LastName, d.AverageRating, r.RideDate
ORDER BY COUNT(r.RideID) DESC;

